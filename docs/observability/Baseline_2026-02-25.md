# DevLens Production Baseline (2026-02-25)

This document establishes baseline metrics and acceptance thresholds for execution phases M1-M4.

## Scope

- Environment: production
- Window: rolling 24h
- Primary flow: analyze -> dashboard -> chat

## Metrics and Thresholds

| Metric | Baseline Source | Current Baseline (2026-02-25) | Target Threshold |
|---|---|---:|---:|
| Analyze success rate | backend job terminal statuses | TBD (capture script below) | >= 95% |
| Chat citation presence rate | chat `done` event payload (`no_citation`) | TBD | >= 80% |
| Chat first-token latency (p95) | `devlens_sse_startup_latency_seconds` | TBD | <= 1.0s |
| Dashboard API latency p95 | `devlens_http_request_duration_seconds` (`/api/v1/repos/{repo_id}/dashboard`) | TBD | <= 0.20s |
| Stage duration p95 (parse/embed/analyze) | `devlens_analysis_stage_duration_seconds` | TBD | track + improve |

## Collection Commands

Use these commands as the canonical baseline collection procedure.

### 1) Backend and dependency health

```bash
curl -fsS https://backend-production-52c13.up.railway.app/health
curl -fsS https://backend-production-52c13.up.railway.app/health/deps
```

### 2) Verify E2E flow (deterministic smoke)

```bash
bash ./scripts/smoke-e2e.sh
```

Windows:

```powershell
./scripts/smoke-e2e.ps1
```

### 3) Metrics scrape snapshot

```bash
curl -fsS https://backend-production-52c13.up.railway.app/metrics > artifacts/metrics/backend_metrics_2026-02-25.prom
```

If worker metrics endpoint is exposed in your environment:

```bash
curl -fsS http://<worker-host>:9101/metrics > artifacts/metrics/worker_metrics_2026-02-25.prom
```

## Notes

- `TBD` values should be filled after one 24h capture window with stable traffic.
- This baseline file is the acceptance reference for Issue #40.
- Smoke flow is the acceptance gate for Issue #41 and CI job `E2E Smoke (Analyze Dashboard Chat)`.
